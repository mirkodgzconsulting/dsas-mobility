---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import VehicleList from '../../../admin/VehicleList';
import { supabase } from '../../../lib/supabase';

const { data: vehicles } = await supabase
    .from('veicoli')
    .select('id, titolo, marca, modello, versione, canone_mensile, immagine_url, promo, noleggio_breve')
    .order('created_at', { ascending: false });

---

<AdminLayout title="Lista Veicoli">
    <div class="w-full py-6">
        <div class="flex justify-between items-end mb-6">
            <div>
                <h1 class="text-2xl font-bold text-gray-800">Gestione Veicoli</h1>
                <p class="text-gray-500 text-sm mt-1">Visualizza, modifica o elimina i veicoli del parco auto.</p>
            </div>
            <a href="/admin/veicoli/create" class="bg-primary text-white font-bold py-2.5 px-5 rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-blue-900/10 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                Nuovo Veicolo
            </a>
        </div>

        <VehicleList initialVehicles={vehicles || []} client:load />
    </div>
</AdminLayout>
